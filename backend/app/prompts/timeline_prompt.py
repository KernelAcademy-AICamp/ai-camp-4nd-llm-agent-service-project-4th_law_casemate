"""
타임라인 자동 생성을 위한 프롬프트
"""

TIMELINE_GENERATION_PROMPT = """당신은 법률 사건의 타임라인을 분석하고 구조화하는 전문가입니다.

다음 사건 정보를 바탕으로 시간순으로 발생한 주요 이벤트들을 타임라인으로 정리해주세요.

## 사건 정보

### 사건 요약
{summary}

### 사실관계
{facts}

### 청구 내용
{claims}

### 증거 목록
{evidence_list}

## 작업 지침

1. 위 정보에서 **구체적인 날짜/시간 정보가 있는 이벤트**를 추출하세요
2. 날짜가 명시되지 않았지만 중요한 이벤트는 "날짜 미상"으로 표시하세요
3. **증거 목록에 "증거 발생일"이 있으면 해당 날짜를 우선적으로 사용하세요**
4. **증거 목록에 "증거 설명"이 있으면 이를 타임라인 description에 참고하세요**
5. **증거 목록의 문서 유형을 적극 활용하세요:**
   - 카카오톡: 대화 내용, 발언 시간, 참여자 정보에 주목
   - 계약서: 계약 체결일, 당사자, 계약 내용에 주목
   - 영수증/금융문서: 거래 날짜, 금액, 거래 상대방에 주목
   - 법원문서: 소송 제기일, 결정일 등 절차적 날짜에 주목
   - 각 문서 유형에 맞는 법적 쟁점 파악
6. 각 이벤트는 다음 기준으로 분류하세요:
   - "의뢰인": 의뢰인(피해자)가 취한 행동
   - "상대방": 상대방(피고소인/가해자)의 행동
   - "증거": 증거 확보/발견 관련
   - "기타": 법률 상담, 소송 제기 등 기타 사건

   **중요: type이 "증거"인 경우, actor 필드에는 반드시 증거 목록에서 언급된 정확한 파일명을 포함하세요.**
7. **각 이벤트의 description에는 다음을 포함하세요:**
   - 구체적인 상황 설명 (누가, 무엇을, 어디서, 어떻게)
   - 증거의 문서 유형을 고려한 구체적인 내용
   - 증거 설명이 있으면 이를 반영하여 작성
   - 해당 이벤트와 관련된 **주요 쟁점사항** (법률적으로 중요한 포인트, 성립 요건, 문제점 등)
   - 쟁점사항은 "[쟁점]" 표시와 함께 명확히 기술
8. 시간순으로 정렬하세요 (오래된 것부터)

## 응답 형식

반드시 아래 JSON 배열 형식으로만 응답하세요. 다른 설명이나 텍스트를 추가하지 마세요.

```json
[
  {{
    "date": "2025-11-15",
    "time": "09:30",
    "title": "이벤트 제목 (간단명료하게)",
    "description": "구체적인 상황 설명 (누가, 무엇을, 어디서, 어떻게). [쟁점] 해당 이벤트와 관련된 법률적 쟁점사항 (성립 요건, 문제점 등)",
    "type": "의뢰인" | "상대방" | "증거" | "기타",
    "actor": "관련 인물명 또는 증거명"
  }}
]
```

## 날짜 형식 규칙
- date: YYYY-MM-DD 형식 (예: 2025-11-15)
- time: HH:MM 형식 (예: 14:30), 시간을 모르면 "00:00"
- 날짜를 모르면 date는 "미상", time은 "00:00"

## 예시 (문서 유형 활용)

**증거: 카카오톡 대화 (증거 발생일 활용 예시)**
증거 목록에서:
- 파일명: 단톡방_대화_캡처.png
- 증거 발생일: 2025-11-15
- 증거 설명: 피고소인이 단톡방에서 의뢰인을 비방한 대화 내용

```json
{{
  "date": "2025-11-15",
  "time": "00:00",
  "title": "단톡방 비방 대화 발생",
  "description": "피고소인이 단톡방에서 의뢰인을 비방한 대화가 발생함. [쟁점] 명예훼손죄의 공연성 요건 충족 여부",
  "type": "상대방",
  "actor": "피고소인"
}}
```

**상대방 행동 (카카오톡 발언)**
```json
{{
  "date": "2025-11-15",
  "time": "09:30",
  "title": "단톡방 비방 발언",
  "description": "피고소인 박OO가 34명 단체 카카오톡 채팅방에서 의뢰인에 대해 '업무능력이 없다'는 발언을 함 (카카오톡 대화 캡처본 확인). [쟁점] 명예훼손죄의 '사실 적시' 요건 충족 여부 및 '공연성' 성립 여부 (다수가 인식할 수 있는 상태)",
  "type": "상대방",
  "actor": "박OO (피고소인)"
}}
```

**증거: 계약서**
```json
{{
  "date": "2025-01-10",
  "time": "14:00",
  "title": "근로계약서 체결",
  "description": "의뢰인과 회사 간 근로계약서 체결. 계약서상 월급 300만원, 주 5일 근무 조건 명시 (근로계약서 원본 보관). [쟁점] 계약서의 효력 및 근로기준법 준수 여부",
  "type": "기타",
  "actor": "회사, 의뢰인"
}}
```

**증거: 영수증**
```json
{{
  "date": "2025-02-15",
  "time": "00:00",
  "title": "손해배상금 지급",
  "description": "피고가 원고에게 손해배상금 500만원을 현금으로 지급함 (영수증 및 거래명세서 보관). [쟁점] 지급 사실의 입증 및 채무 이행 완료 여부",
  "type": "상대방",
  "actor": "피고"
}}
```

이제 위 사건 정보를 바탕으로 타임라인 JSON을 생성해주세요:
"""


def create_timeline_prompt(summary: str, facts: str, claims: str, evidence_list: str) -> str:
    """
    타임라인 생성 프롬프트 생성

    Args:
        summary: 사건 요약
        facts: 사실관계
        claims: 청구 내용
        evidence_list: 증거 목록 (텍스트)

    Returns:
        완성된 프롬프트
    """
    return TIMELINE_GENERATION_PROMPT.format(
        summary=summary or "없음",
        facts=facts or "없음",
        claims=claims or "없음",
        evidence_list=evidence_list or "없음"
    )
